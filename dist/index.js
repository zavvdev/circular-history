var g=Object.defineProperty;var p=(t,e)=>g(t,"name",{value:e,configurable:!0});var m=["number","string","bigint","boolean","symbol","object"],u=0,a=-1,s={empty:Symbol("empty")},v=p(t=>m.includes(t),"isTypeAllowed"),y=p(t=>{var e=typeof t,o=e==="object"&&t!==null;return o||v(e)},"isValueTypeAllowed"),l=p((t,e)=>y(t)&&typeof t===e,"canCommit"),d=p(t=>t===void 0,"isItemEmpty"),f=p((t,e)=>t%e,"makeIndex"),r=new WeakMap;function n(t,e){if(typeof t!="number"||t<=0||!Number.isInteger(t))throw new Error(`Capacity must be a positive integer. Got "${t}".`);if(!v(e))throw new Error(`"${e}" is not allowed`);r.set(this,{navigationUpperBound:u,navigatedItemsCount:u,pointer:a,capacity:t,dataType:e,buffer:new Array(t)})}p(n,"CircularHistory");n.prototype.commit=function(t){var e=r.get(this),o=e.dataType;if(!l(t,o))throw new Error(`Type of ${t} is invalid. Expected "${o}", got "${t===null?"null":typeof t}".`);var i=e.capacity;e.navigatedItemsCount===i-1?(e.navigationUpperBound=i-1,e.navigatedItemsCount=i-1):e.navigationUpperBound=++e.navigatedItemsCount,e.buffer[f(++e.pointer,i)]=t};n.prototype.current=function(){var t=r.get(this);if(t.pointer===a)return s.empty;var e=t.buffer,o=t.pointer,i=e[f(o,t.capacity)];return d(i)?s.empty:i};n.prototype.moveBackward=function(){var t=r.get(this);if(t.pointer===a+1){t.pointer=a;return}t.navigatedItemsCount===u||t.pointer===a||(t.pointer--,t.navigatedItemsCount--)};n.prototype.moveForward=function(){var t=r.get(this);if(t.pointer===a&&t.navigationUpperBound>u){t.pointer=a+1;return}t.navigatedItemsCount!==t.navigationUpperBound&&(t.pointer++,t.navigatedItemsCount++)};n.prototype.clear=function(){var t=r.get(this);t.navigatedItemsCount=u,t.navigationUpperBound=u,t.pointer=a,t.buffer=new Array(t.capacity)};n.prototype.dump=function(t=!1){var e=r.get(this),o=[...e.buffer];return t?o.filter(i=>!d(i)):o};n.prototype.getCurrentIndex=function(){var t=r.get(this);return f(t.pointer,t.capacity)};n.prototype.isStartReached=function(){var t=r.get(this);return t.navigatedItemsCount===u||t.pointer===a};n.prototype.isEndReached=function(){var t=r.get(this);return t.navigatedItemsCount===t.navigationUpperBound};n.FLAGS=s;export{n as CircularHistory};
